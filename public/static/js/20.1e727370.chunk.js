(this.webpackJsonpb2b=this.webpackJsonpb2b||[]).push([[20],{749:function(e,t,a){"use strict";var n=a(755),i=a(756),c=a(26),r=a(757),o=a.n(r),l=a(758),s=a.n(l);t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=new s.a.Workbook,l=r.addWorksheet(c.a.t("DataGrid"));Object(n.exportDataGrid)({component:e.component,worksheet:l,customizeCell:function(e){var n=e.gridCell,r=e.excelCell;if("data"===n.rowType){var o=a.find((function(e){return n.column.dataField===e.name}));o&&n.value&&(r.value=n.value.map((function(e){return o.data.find((function(t){return t[o.fieldName1]===e[o.fieldName2]}))[o.displayName]})).join()),t.find((function(e){return n.column.dataField===e}))&&(r.value=Object(i.htmlToText)(n.value,{wordwrap:null})),"creatAt"===n.column.dataField&&(r.value=new Date(n.value).toDateString()),"isActive"===n.column.dataField&&(r.value=n.value?c.a.t("YES"):c.a.t("NO"))}"group"===n.rowType&&(r.fill={type:"pattern",pattern:"solid",fgColor:{argb:"BEDFE6"}}),"totalFooter"===n.rowType&&r.value&&(r.font.italic=!0)}}).then((function(){r.xlsx.writeBuffer().then((function(e){o()(new Blob([e],{type:"application/octet-stream"}),"DataGrid.xlsx")}))})),e.cancel=!0}},984:function(e,t,a){"use strict";a.r(t);var n=a(53),i=a(0),c=a(742),r=a(460),o=a(815),l=a(753),s=a.n(l),u=a(751),d=(a(781),a(456)),j=a(89),b=a(31),p=a(8),O=a(762),f=a(64),m=a(739),x=a(732),h=a(68),v=a(754),g=a(1),S=Object(i.memo)(Object(x.a)()((function(e){var t=e.id,a=e.features,r=e.onSave,o=e.t,u=Object(i.useState)(a),d=Object(n.a)(u,2),x=d[0],S=d[1],w=Object(i.useState)([]),F=Object(n.a)(w,2),y=F[0],E=F[1],C=Object(i.useState)(!1),k=Object(n.a)(C,2),I=k[0],D=k[1],P=Object(i.useState)(""),A=Object(n.a)(P,2),T=A[0],R=A[1],V=function(){var e=Object(f.a)(Object(b.a)().mark((function e(){var a,n,i,c,r;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.b.get("/admin/subscription/package/".concat(t,"/features"));case 3:for(a=e.sent,n=a.data.data,i=Object(O.a)(x),c=0;c<x.length;c++)for(r=0;r<n.length;r++)x[c].idSubscriptionFeature===n[r].subscriptionFeatureId&&(i[c].featureValue=n[r].featureValue);S(i),E(n.map((function(e){return Object(p.a)(Object(p.a)({},e),{},{idSubscriptionFeature:e.subscriptionFeatureId})}))),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),R(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,D(!0),e.next=4,h.b.post("/admin/subscription/package/features/reset",{features:y.filter((function(e){return e.featureValue})).map((function(e){return Object(p.a)(Object(p.a)({},e),{},{subscriptionFeatureId:e.idSubscriptionFeature})})),subscriptionPackageId:t});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),R(e.t0);case 9:return e.prev=9,D(!1),r&&r(),e.finish(9);case 13:case"end":return e.stop()}}),e,null,[[0,6,9,13]])})));return function(){return e.apply(this,arguments)}}();return Object(i.useEffect)((function(){return V(),function(){return E([])}}),[]),T?Object(g.jsx)(j.b,{}):Object(g.jsxs)(c.a,{basic:!0,children:[Object(g.jsxs)(s.a,{dataSource:x,keyExpr:"idSubscriptionFeature",wordWrapEnabled:!0,columnAutoWidth:!0,showBorders:!0,columnHidingEnabled:!0,hoverStateEnabled:!0,loadPanel:{indicatorSrc:v.a},selectedRowKeys:y.map((function(e){return e.idSubscriptionFeature})),onSelectionChanged:function(e){return E(e.selectedRowsData.length&&e.selectedRowsData.filter((function(e){return e.featureValue}))||[])},children:[Object(g.jsx)(l.Editing,{mode:"batch",useIcons:!0,allowUpdating:!0,refreshMode:"reshape"}),Object(g.jsx)(l.Selection,{mode:"multiple"}),Object(g.jsx)(l.Column,{dataField:"nameEn",allowEditing:!1,caption:o("Name")}),Object(g.jsx)(l.Column,{dataField:"descriptionEn",allowEditing:!1,caption:o("Description")}),Object(g.jsx)(l.Column,{dataField:"featureValue",dataType:"number",caption:o("Value")})]}),Object(g.jsx)(c.a,{basic:!0,textAlign:"right",children:Object(g.jsx)(m.a,{onClick:B,positive:!0,loading:I,children:o("Save")})})]})}))),w=a(752),F=a(749),y=a(38),E=[{store:w.j,name:"features"}];t.default=Object(y.b)((function(e){e.PERMISSIONS;var t=e.features,a=Object(d.a)().t,b=Object(i.useState)(!1),p=Object(n.a)(b,2),O=p[0],f=p[1],m=Object(i.useState)([]),x=Object(n.a)(m,2),h=x[0],y=x[1],E=function(){f(!1),y([])};return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)(c.a,{basic:!0,children:[Object(g.jsx)(j.d,{title:a("Packages")}),Object(g.jsx)(c.a,{basic:!0,children:Object(g.jsxs)(s.a,{dataSource:w.o,showBorders:!0,columnHidingEnabled:!0,wordWrapEnabled:!0,columnAutoWidth:!0,repaintChangesOnly:!0,remoteOperations:!0,loadPanel:{indicatorSrc:v.a},onExporting:F.a,children:[Object(g.jsx)(l.RemoteOperations,{grouping:!0}),Object(g.jsx)(l.Sorting,{mode:"multiple"}),Object(g.jsx)(l.Grouping,{autoExpandAll:!1}),Object(g.jsx)(l.FilterRow,{visible:!0}),Object(g.jsx)(l.FilterPanel,{visible:!0}),Object(g.jsx)(l.Scrolling,{mode:"virtual"}),Object(g.jsx)(l.SearchPanel,{visible:!0}),Object(g.jsxs)(l.Editing,{mode:"popup",useIcons:!0,allowUpdating:!0,allowDeleting:!0,allowAdding:!0,refreshMode:"reshape",children:[Object(g.jsx)(l.Popup,{title:a("Package"),showTitle:!0,resizeEnabled:!0,children:Object(g.jsx)(l.Position,{my:"middle",at:"middle",of:window})}),Object(g.jsx)(l.Form,{children:Object(g.jsxs)(u.Item,{itemType:"group",colCount:2,colSpan:2,children:[Object(g.jsx)(u.Item,{isRequired:!0,dataField:"nameEn"}),Object(g.jsx)(u.Item,{isRequired:!0,dataField:"priceUsd"}),Object(g.jsx)(u.Item,{isRequired:!0,dataField:"validitySeconds"}),Object(g.jsx)(u.Item,{dataField:"isActive"}),Object(g.jsx)(u.Item,{dataField:"descriptionEn",editorType:"dxTextArea",colSpan:2,editorOptions:{height:100}}),Object(g.jsx)(u.Item,{dataField:"imgUrl",colSpan:2})]})})]}),Object(g.jsx)(l.Column,{dataField:"imgUrl",width:100,allowSorting:!1,allowFiltering:!1,caption:a("Photo"),cellRender:function(e){var t=e.value;return Object(g.jsx)(r.a,{src:t,fluid:!0})},editCellComponent:j.e}),Object(g.jsx)(l.Column,{dataField:"nameEn",caption:a("Name")}),Object(g.jsx)(l.Column,{dataField:"descriptionEn",caption:a("Description"),cellRender:function(e){return function(e,t){if(!e)return null;var a=t||70;return e.length<=a?e:e.slice(0,a)+"..."}(e.value)}}),Object(g.jsx)(l.Column,{dataField:"priceUsd",caption:a("Price"),format:{type:"currency",precision:2}}),Object(g.jsx)(l.Column,{calculateDisplayValue:function(e){var t=e.validitySeconds;return"".concat(t/60/60/24," ").concat(a("Days"))},dataType:"number",dataField:"validitySeconds",calculateFilterExpression:function(e,t){return["validitySeconds",t||"=",60*e*60*24]},calculateCellValue:function(e){return e.validitySeconds/60/60/24},caption:a("Validity")}),Object(g.jsx)(l.Column,{caption:a("Active"),dataType:"boolean",dataField:"isActive"}),Object(g.jsxs)(l.Column,{type:"buttons",caption:a("Actions"),children:[Object(g.jsx)(l.Button,{name:"edit"}),Object(g.jsx)(l.Button,{name:"delete"}),Object(g.jsx)(l.Button,{hint:a("Features"),icon:"bulletlist",onClick:function(e){y([e.row.data.idSubscriptionPackage]),f(!0)}})]})]})})]}),Object(g.jsx)(o.a,{onClose:E,open:O,content:Object(g.jsx)(S,{id:h[0],features:t,onSave:E}),closeIcon:!0,header:a("Features"),size:"large",centered:!0,closeOnDimmerClick:!1})]})}),E)}}]);
//# sourceMappingURL=20.1e727370.chunk.js.map