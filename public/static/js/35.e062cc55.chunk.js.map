{"version":3,"sources":["pages/admin section/hr/Resources.js","pages/admin section/hr/Roles.js"],"names":["withTranslation","t","roleId","resources","PERMISSIONS","useState","selectedResources","setSelectedResources","loading","setLoading","error","setError","activeIndex","setActiveIndex","expandAll","setExpandAll","handleClick","e","titleProps","index","useEffect","getRoleResources","roleResourcesDataGrid","load","data","map","r","permissions","idResource","setRoleResourcues","resourceToSend","id","Object","keys","filter","k","reset","length","Segment","basic","Grid","columns","GridColumn","Header","as","textAlign","Icon","link","name","onClick","Accordion","Menu","vertical","fluid","Item","Title","active","content","style","padding","margin","color","toUpperCase","Content","Form","unstackable","size","Group","inline","widths","label","value","p","Checkbox","checked","onChange","rIndex","permission","newResourcers","onPermissionChanged","Divider","hidden","UPDATE","Button","icon","positive","labelPosition","setResourcers","getAllResources","allResourcesDataLookup","title","dataSource","rolesDataGrid","showBorders","showColumnLines","columnHidingEnabled","wordWrapEnabled","columnAutoWidth","repaintChangesOnly","remoteOperations","hoverStateEnabled","onSelectionChanged","component","collapseAll","expandRow","currentSelectedRowKeys","onContentReady","getSelectedRowKeys","loadPanel","indicatorSrc","LoadingGifImage","mode","visible","useIcons","allowUpdating","allowDeleting","DELETE","allowAdding","ADD","refreshMode","itemType","colCount","colSpan","dataField","isRequired","caption","setCellValue","newData","idRole","replaceAll","enabled","render"],"mappings":"6SA0GeA,iBApGG,SAAH,GAA+C,IAAzCC,EAAC,EAADA,EAAGC,EAAM,EAANA,OAAQC,EAAS,EAATA,UAAWC,EAAW,EAAXA,YACvC,EAAkDC,mBAAS,IAAG,mBAAvDC,EAAiB,KAAEC,EAAoB,KAC9C,EAA8BF,oBAAS,GAAM,mBAAtCG,EAAO,KAAEC,EAAU,KAC1B,EAA0BJ,mBAAS,IAAG,mBAA/BK,EAAK,KAAEC,EAAQ,KACtB,EAAsCN,mBAAS,GAAE,mBAA1CO,EAAW,KAAEC,EAAc,KAClC,EAAkCR,oBAAS,GAAM,mBAA1CS,EAAS,KAAEC,EAAY,KAExBC,EAAc,SAACC,EAAGC,GACpB,IAAQC,EAAUD,EAAVC,MAERN,EADiBD,IAAgBO,GAAS,EAAIA,EAElD,EAQAC,qBAAU,WAEN,OADAC,IACO,kBAAMd,EAAqB,GAAI,CAE1C,GAAG,IAEH,IAAMc,EAAgB,iDAAG,yHAEMC,YAAsBpB,GAAQqB,OAAO,KAAD,WAAnDC,EAAI,EAAJA,KACRjB,EAAqBJ,EAAUsB,KAAI,SAAAC,GAAC,kCAAUA,GAAC,IAAEC,YAAY,2BAAMD,EAAEC,aAAgBH,EAAKE,EAAEE,cAAa,KAAM,gDAE/GjB,EAAS,EAAD,IAAM,yDAErB,kBAPqB,mCAShBkB,EAAiB,iDAAG,8FAG8H,OAFpJpB,GAAW,GAAM,SAEPqB,EAAiBxB,EAAkBmB,KAAI,SAAAC,GAAC,MAAK,CAAEK,GAAIL,EAAEE,WAAYD,YAAaK,OAAOC,KAAKP,EAAEC,aAAaO,QAAO,SAAAC,GAAC,OAAIT,EAAEC,YAAYQ,EAAE,IAAG,IAAG,EAAD,OAC1Ib,IAAsBc,MAAMlC,EAAQ4B,GAAgB,KAAD,kDAEzDnB,EAAS,EAAD,IAAM,QAEI,OAFJ,UAEdF,GAAW,GAAO,4EAEzB,kBAVsB,mCAYvB,OAAKH,EAAkB+B,OACnB3B,EAAc,cAAC,IAAY,IAG3B,eAAC4B,EAAA,EAAO,CAACC,OAAK,YACV,eAACC,EAAA,EAAI,CAACC,QAAQ,IAAG,UACb,cAACC,EAAA,EAAU,UACP,cAACC,EAAA,EAAM,CAACC,GAAG,KAAI,SAAE3C,EAAE,iBAGvB,cAACyC,EAAA,EAAU,CAACG,UAAU,QAAO,SACzB,cAACC,EAAA,EAAI,CAACC,MAAI,EAACC,KAAMlC,EAAY,WAAa,SAAUmC,QAAS,kBAAMlC,GAAcD,EAAU,SAGnG,cAACoC,EAAA,EAAS,CAACN,GAAIO,IAAMC,UAAQ,EAACC,OAAK,WAE3B/C,EAAkBmB,KAAI,SAACC,EAAGP,GACtB,OAAO,eAACgC,EAAA,EAAKG,KAAI,WAEb,cAACJ,EAAA,EAAUK,MAAK,CACZC,SAAQ1C,GAAmBF,IAAgBO,EAC3CsC,QAAS,cAACd,EAAA,EAAM,CAACC,GAAG,KAAKc,MAAO,CAAEC,QAAS,EAAGC,OAAQ,GAAKC,MAAO/C,GAAqBF,IAAgBO,EAAzB,OAA0C,QAAQ,SAAEO,EAAEsB,KAAKc,gBACzI3C,MAAOA,EACP8B,QAASnC,EAAY,KAAOE,IAEhC,cAACkC,EAAA,EAAUa,QAAO,CACdP,SAAQ1C,GAAmBF,IAAgBO,EAC3CsC,QACI,cAACO,EAAA,EAAI,CAACC,aAAW,EAACC,KAAK,OAAM,SACzB,cAACF,EAAA,EAAKG,MAAK,CAACC,QAAM,EAACC,OAAO,QAAO,SAGzBrC,OAAOC,KAAKP,EAAEC,aACTF,KAAI,SAAAU,GAAC,MAAK,CAAEmC,MAAOnC,EAAGoC,MAAO7C,EAAEC,YAAYQ,GAAI,IAC/CV,KAAI,SAAA+C,GAAC,OAAI,cAACR,EAAA,EAAKS,SAAQ,CAEpBH,MAAOrE,EAAEuE,EAAEF,OACXI,QAASF,EAAED,MACXI,SAAU,kBAvElC,SAACC,EAAQC,GACjC,IAAMC,EAAa,YAAOxE,GAC1BwE,EAAcF,GAAQjD,YAAYkD,EAAWP,QAAUO,EAAWN,MAClEhE,EAAqBuE,EACzB,CAmEoEC,CAAoB5D,EAAOqD,EAAE,GAHxCA,EAAEF,MAIT,YAtBPnD,EA4B3B,MAGR,cAAC6D,EAAA,EAAO,CAACC,QAAM,IACd7E,EAAY8E,QAAU,cAACC,EAAA,EAAM,CAACC,KAAK,OAAO5E,QAASA,EAAS6E,UAAQ,EAACC,cAAc,OAAO7B,QAASxD,EAAE,QAASgD,QAASpB,OAjD1F,cAACS,EAAA,EAAO,CAACC,OAAK,EAAC/B,SAAO,GAoDhE,I,SCPeR,yBAvFD,SAAH,GAA4B,IAAtBC,EAAC,EAADA,EAAGG,EAAW,EAAXA,YAEhB,EAAmCC,mBAAS,IAAG,mBAAxCF,EAAS,KAAEoF,EAAa,KAW/BnE,qBAAU,WACDjB,EAAUkC,QACXmD,GAER,GAAG,IAEH,IAAMA,EAAe,iDAAG,yHAEOC,IAAuBlE,OAAO,KAAD,WAA5CC,EAAI,EAAJA,KACR+D,EAAc/D,GAAM,yGAI3B,kBAPoB,mCASrB,OACI,eAACc,EAAA,EAAO,CAACC,OAAK,YACV,cAAC,IAAU,CAACmD,MAAOzF,EAAE,WACrB,cAACqC,EAAA,EAAO,CAACC,OAAK,WACV,eAAC,IAAQ,CACLoD,WAAYC,IACZC,aAAW,EACXC,iBAAe,EACfC,qBAAmB,EACnBC,iBAAe,EACfC,iBAAe,EACfC,oBAAkB,EAClBC,kBAAgB,EAChBC,mBAAiB,EACjBC,mBAlCS,SAACpF,GACtBA,EAAEqF,UAAUC,aAAa,GACzBtF,EAAEqF,UAAUE,UAAUvF,EAAEwF,uBAAuB,GACnD,EAiCgBC,eAzCK,SAACzF,GACbA,EAAEqF,UAAUK,qBAAqBtE,MAG1C,EAsCgBuE,UAAW,CAAEC,aAAcC,KAAkB,UAE7C,cAAC,UAAO,CAACC,KAAK,aACd,cAAC,YAAS,CAACC,SAAO,IAClB,cAAC,cAAW,CAACA,SAAO,IACpB,cAAC,YAAS,CAACD,KAAK,YAChB,cAAC,cAAW,CAACC,SAAO,IACpB,cAAC,YAAS,CAACD,KAAK,WAChB,cAAC,UAAO,CACJA,KAAK,OACLE,UAAQ,EACRC,cAAe9G,EAAY8E,OAC3BiC,cAAe/G,EAAYgH,OAC3BC,YAAajH,EAAYkH,IACzBC,YAAY,UAAS,SAGrB,cAAC,OAAI,UACD,cAAC,OAAI,CAACC,SAAS,QAAQC,SAAU,EAAGC,QAAS,EAAE,SAC3C,cAAC,OAAI,CACDC,UAAU,OACVD,QAAS,EACTE,YAAU,UAO1B,cAAC,SAAM,CAACD,UAAU,SAASE,QAAS5H,EAAE,QACtC,cAAC,SAAM,CAAC0H,UAAU,OAAOE,QAAS5H,EAAE,QAAS6H,aAAc,SAACC,EAASxD,GACjEwD,EAAQC,OAASzD,EAAM0D,WAAW,IAAK,KAAKnE,cAC5CiE,EAAQ/E,KAAOuB,CACnB,IAEA,cAAC,eAAY,CAAC2D,SAAS,EAAOC,OAAQ,gBAAWH,EAAM,EAAdxG,KAAQwG,OAAM,OAAS,cAAC,EAAS,CAAC9H,OAAQ8H,EAAQ5H,YAAaA,EAAaD,UAAWA,GAAa,WAKjK,G","file":"static/js/35.e062cc55.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Button, Divider, Segment, Accordion, Menu, Form, Header, Grid, GridColumn, Icon } from 'semantic-ui-react';\r\nimport { withTranslation } from 'react-i18next';\r\nimport { roleResourcesDataGrid } from '../../../Data Stores';\r\nimport { ErrorSegment } from '../../../components';\r\n\r\nconst Resources = ({ t, roleId, resources, PERMISSIONS }) => {\r\n    const [selectedResources, setSelectedResources] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n    const [error, setError] = useState('');\r\n    const [activeIndex, setActiveIndex] = useState(0);\r\n    const [expandAll, setExpandAll] = useState(false);\r\n\r\n    const handleClick = (e, titleProps) => {\r\n        const { index } = titleProps;\r\n        const newIndex = activeIndex === index ? -1 : index;\r\n        setActiveIndex(newIndex);\r\n    };\r\n\r\n    const onPermissionChanged = (rIndex, permission) => {\r\n        const newResourcers = [...selectedResources];\r\n        newResourcers[rIndex].permissions[permission.label] = !permission.value;\r\n        setSelectedResources(newResourcers);\r\n    };\r\n\r\n    useEffect(() => {\r\n        getRoleResources();\r\n        return () => setSelectedResources([]);\r\n        //eslint-disable-next-line\r\n    }, []);\r\n\r\n    const getRoleResources = async () => {\r\n        try {\r\n            const { data } = await roleResourcesDataGrid(roleId).load();\r\n            setSelectedResources(resources.map(r => ({ ...r, permissions: { ...r.permissions, ...data[r.idResource] } })));\r\n        } catch (err) {\r\n            setError(err);\r\n        }\r\n    };\r\n\r\n    const setRoleResourcues = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const resourceToSend = selectedResources.map(r => ({ id: r.idResource, permissions: Object.keys(r.permissions).filter(k => r.permissions[k]) }));\r\n            await roleResourcesDataGrid.reset(roleId, resourceToSend);\r\n        } catch (err) {\r\n            setError(err);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    if (!selectedResources.length) return <Segment basic loading />;\r\n    if (error) return <ErrorSegment />;\r\n\r\n    return (\r\n        <Segment basic>\r\n            <Grid columns='2'>\r\n                <GridColumn>\r\n                    <Header as='h4'>{t('Resources')}</Header>\r\n                </GridColumn>\r\n\r\n                <GridColumn textAlign='right'>\r\n                    <Icon link name={expandAll ? 'compress' : 'expand'} onClick={() => setExpandAll(!expandAll)} />\r\n                </GridColumn>\r\n            </Grid>\r\n            <Accordion as={Menu} vertical fluid>\r\n                {\r\n                    selectedResources.map((r, index) => {\r\n                        return <Menu.Item key={index}>\r\n\r\n                            <Accordion.Title\r\n                                active={expandAll ? true : activeIndex === index}\r\n                                content={<Header as='h4' style={{ padding: 0, margin: 0 }} color={expandAll ? 'blue' : activeIndex === index ? 'blue' : 'black'}>{r.name.toUpperCase()}</Header>}\r\n                                index={index}\r\n                                onClick={expandAll ? null : handleClick}\r\n                            />\r\n                            <Accordion.Content\r\n                                active={expandAll ? true : activeIndex === index}\r\n                                content={\r\n                                    <Form unstackable size='mini'>\r\n                                        <Form.Group inline widths='equal'>\r\n                                            {\r\n\r\n                                                Object.keys(r.permissions)\r\n                                                    .map(k => ({ label: k, value: r.permissions[k] }))\r\n                                                    .map(p => <Form.Checkbox\r\n                                                        key={p.label}\r\n                                                        label={t(p.label)}\r\n                                                        checked={p.value}\r\n                                                        onChange={() => onPermissionChanged(index, p)}\r\n                                                    />)\r\n                                            }\r\n                                        </Form.Group>\r\n                                    </Form>\r\n                                } />\r\n                        </Menu.Item>;\r\n                    })\r\n                }\r\n            </Accordion>\r\n            <Divider hidden />\r\n            {PERMISSIONS.UPDATE && <Button icon='save' loading={loading} positive labelPosition='left' content={t('Save')} onClick={setRoleResourcues} />}\r\n        </Segment>\r\n    );\r\n};\r\n\r\nexport default withTranslation()(Resources);\r\n","import React, { useEffect, useState } from 'react';\r\nimport { Segment } from 'semantic-ui-react';\r\nimport DataGrid, { Column, Editing, FilterPanel, FilterRow, Form, MasterDetail, Scrolling, SearchPanel, Selection, Sorting } from 'devextreme-react/data-grid';\r\nimport { Item } from 'devextreme-react/ui/form';\r\nimport { withTranslation } from 'react-i18next';\r\nimport Resources from './Resources';\r\nimport { PageHeader } from '../../../components';\r\nimport { rolesDataGrid, allResourcesDataLookup } from '../../../Data Stores';\r\nimport LoadingGifImage from '../../../res/images/loading.gif';\r\n\r\nconst Roles = ({ t, PERMISSIONS }) => {\r\n\r\n    const [resources, setResourcers] = useState([]);\r\n    const contentReady = (e) => {\r\n        if (!e.component.getSelectedRowKeys().length) {\r\n            // e.component.selectRowsByIndexes(0);\r\n        }\r\n    };\r\n    const selectionChanged = (e) => {\r\n        e.component.collapseAll(-1);\r\n        e.component.expandRow(e.currentSelectedRowKeys[0]);\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (!resources.length)\r\n            getAllResources();\r\n        //eslint-disable-next-line\r\n    }, []);\r\n\r\n    const getAllResources = async () => {\r\n        try {\r\n            const { data } = await allResourcesDataLookup.load();\r\n            setResourcers(data);\r\n        } catch (err) {\r\n\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Segment basic>\r\n            <PageHeader title={t('Roles')} />\r\n            <Segment basic>\r\n                <DataGrid\r\n                    dataSource={rolesDataGrid}\r\n                    showBorders\r\n                    showColumnLines\r\n                    columnHidingEnabled\r\n                    wordWrapEnabled\r\n                    columnAutoWidth\r\n                    repaintChangesOnly\r\n                    remoteOperations\r\n                    hoverStateEnabled\r\n                    onSelectionChanged={selectionChanged}\r\n                    // selectedRowKeys={row}\r\n                    onContentReady={contentReady}\r\n                    loadPanel={{ indicatorSrc: LoadingGifImage }}\r\n                >\r\n                    <Sorting mode='multiple' />\r\n                    <FilterRow visible />\r\n                    <FilterPanel visible />\r\n                    <Scrolling mode=\"virtual\" />\r\n                    <SearchPanel visible />\r\n                    <Selection mode='single' />\r\n                    <Editing\r\n                        mode='form'\r\n                        useIcons\r\n                        allowUpdating={PERMISSIONS.UPDATE}\r\n                        allowDeleting={PERMISSIONS.DELETE}\r\n                        allowAdding={PERMISSIONS.ADD}\r\n                        refreshMode='reshape'\r\n                    >\r\n\r\n                        <Form>\r\n                            <Item itemType=\"group\" colCount={2} colSpan={2}>\r\n                                <Item\r\n                                    dataField=\"name\"\r\n                                    colSpan={2}\r\n                                    isRequired\r\n                                />\r\n                            </Item>\r\n                        </Form>\r\n                    </Editing>\r\n\r\n\r\n                    <Column dataField=\"idRole\" caption={t('ID')} />\r\n                    <Column dataField=\"name\" caption={t('Name')} setCellValue={(newData, value) => {\r\n                        newData.idRole = value.replaceAll(\" \", \"_\").toUpperCase();\r\n                        newData.name = value;\r\n                    }} />\r\n\r\n                    <MasterDetail enabled={false} render={({ data: { idRole } }) => <Resources roleId={idRole} PERMISSIONS={PERMISSIONS} resources={resources} />} />\r\n                </DataGrid>\r\n            </Segment>\r\n        </Segment>\r\n    );\r\n};\r\n\r\nexport default withTranslation()(Roles);\r\n"],"sourceRoot":""}